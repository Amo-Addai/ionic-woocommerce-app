<ion-header>
    <ion-navbar>
        <ion-title>Checkout</ion-title>
    </ion-navbar>
</ion-header>

<ion-content>
    
    <ion-list>

        <ion-item-divider color="danger">
            Personal Details
        </ion-item-divider>
        <ion-item>
            <ion-label>First Name</ion-label>
            <!-- no optional-chain for 1st .prop data-binding (2-way) -->
            <ion-input type="text" [(ngModel)]="newOrder.first_name"></ion-input>
        </ion-item>
        <ion-item>
            <ion-label>Last Name</ion-label>
            <ion-input type="text" [(ngModel)]="newOrder.last_name"></ion-input>
        </ion-item>
        <ion-item>
            <ion-label>Email</ion-label>
            <ion-input type="email" [(ngModel)]="newOrder.email" (blur)="checkInput('email')"></ion-input>
        </ion-item>
        <ion-item>
            <ion-label>Phone</ion-label>
            <ion-input type="tel" clearInput [(ngModel)]="newOrder.phone"></ion-input>
        </ion-item>
        <ion-item>
            <ion-label>Username</ion-label>
            <ion-input type="text" [(ngModel)]="newOrder.username"></ion-input>
        </ion-item>
        <ion-item>
            <ion-label>Password</ion-label>
            <ion-input type="password" [(ngModel)]="newOrder.password"></ion-input>
        </ion-item>
        <ion-item>
            <ion-label>Confirm Password</ion-label>
            <ion-input type="password" [(ngModel)]="newOrder.confirm_password"></ion-input>
        </ion-item>

        <ion-item-divider color="danger">
            Billing Details
        </ion-item-divider>
        <ion-item>
            <ion-label>Address Line 1</ion-label>
            <!-- no optional-chain for 1st .prop data-binding (2-way) if obj = {} by default in .component.ts -->
            <!-- but for 2nd ?.prop because 1st must be init'd as an object - obj = { prop: {} } -->
            <ion-textarea type="text" maxlength="80" [(ngModel)]="newOrder.billing_address?.address_1"></ion-textarea>
        </ion-item>
        <ion-item>
            <ion-label>Address Line 2</ion-label>
            <ion-textarea type="text" maxlength="80" [(ngModel)]="newOrder.billing_address?.address_2"></ion-textarea>
        </ion-item>
        <ion-item>
            <ion-label>Country</ion-label>
            <ion-select [(ngModel)]="newOrder.billing_address?.country">
                <ion-option value="Ghana" selected="true">Ghana</ion-option>
            </ion-select>
        </ion-item>
        <ion-item>
            <ion-label>State</ion-label>
            <ion-select [(ngModel)]="newOrder.billing_address?.state">
                <ion-option value="Greater Accra" selected="true">Greater Accra</ion-option>
                <ion-option value="Cape Coast" selected="true">Cape Coast</ion-option>
                <ion-option value="Volta" selected="true">Volta</ion-option>
                <ion-option value="Eastern Region" selected="true">Eastern Region</ion-option>
                <ion-option value="Western Region" selected="true">Western Region</ion-option>
                <ion-option value="Ashanti Region" selected="true">Ashanti Region</ion-option>
            </ion-select>
        </ion-item>
        <ion-item>
            <ion-label>City</ion-label>
            <ion-input type="text" [(ngModel)]="newOrder.billing_address?.city"></ion-input>
        </ion-item>
        <ion-item>
            <ion-label>Postal Code</ion-label>
            <ion-input type="number" clearInput [(ngModel)]="newOrder.billing_address?.postal_code"></ion-input>
        </ion-item>
        <ion-item>
            <ion-label>Phone Number</ion-label>
            <ion-input type="tel" clearInput [(ngModel)]="newOrder.billing_number?.phone"></ion-input>
        </ion-item>

        <ion-item-divider color="danger">
            Same as Shipping Address:
        </ion-item-divider>
        <ion-item>
            <ion-item>Is Shipping Address?</ion-item>
            <ion-toggle [(ngModel)]="same_billing_shipping" (click)="toggleSameAddress()"></ion-toggle>
            <!-- <ion-checkbox (ionChange)="toggleIsSameAddress()"></ion-checkbox> -->
        </ion-item>

        <ion-content *ngIf="!same_billing_shipping">

            <ion-item-divider color="danger">
                Shipping Details
            </ion-item-divider>
            <ion-item>
                <ion-label>Address Line 1</ion-label>
                <!-- no optional-chain for 1st .prop data-binding (2-way) if obj = {} by default in .component.ts -->
                <!-- but for 2nd ?.prop because 1st must be init'd as an object - obj = { prop: {} } -->
                <ion-textarea type="text" maxlength="80" [(ngModel)]="newOrder.shipping_address?.address_1"></ion-textarea>
            </ion-item>
            <ion-item>
                <ion-label>Address Line 2</ion-label>
                <ion-textarea type="text" maxlength="80" [(ngModel)]="newOrder.shipping_address?.address_2"></ion-textarea>
            </ion-item>
            <ion-item>
                <ion-label>Country</ion-label>
                <ion-select [(ngModel)]="newOrder.shipping_address?.country">
                    <ion-option value="Ghana" selected="true">Ghana</ion-option>
                </ion-select>
            </ion-item>
            <ion-item>
                <ion-label>State</ion-label>
                <ion-select [(ngModel)]="newOrder.shipping_address?.state">
                    <ion-option value="Greater Accra" selected="true">Greater Accra</ion-option>
                    <ion-option value="Cape Coast" selected="true">Cape Coast</ion-option>
                    <ion-option value="Volta" selected="true">Volta</ion-option>
                    <ion-option value="Eastern Region" selected="true">Eastern Region</ion-option>
                    <ion-option value="Western Region" selected="true">Western Region</ion-option>
                    <ion-option value="Ashanti Region" selected="true">Ashanti Region</ion-option>
                </ion-select>
            </ion-item>
            <ion-item>
                <ion-label>City</ion-label>
                <ion-input type="text" [(ngModel)]="newOrder.shipping_address?.city"></ion-input>
            </ion-item>
            <ion-item>
                <ion-label>Postal Code</ion-label>
                <ion-input type="number" clearInput [(ngModel)]="newOrder.shipping_address?.postal_code"></ion-input>
            </ion-item>
            <ion-item>
                <ion-label>Phone Number</ion-label>
                <ion-input type="tel" clearInput [(ngModel)]="newOrder.billing_number?.phone"></ion-input>
            </ion-item>
    
            <ion-item-divider color="danger">
                Same as Shipping Address:
            </ion-item-divider>
            <ion-item>
                <ion-item>Is Shipping Address?</ion-item>
                <ion-toggle [(ngModel)]="same_billing_shipping"></ion-toggle>
            </ion-item>
            
        </ion-content>

        <ion-item-divider color="danger">
            Payment Details
        </ion-item-divider>
        <ion-item>
            <ion-label>Payment Method</ion-label>
            <ion-select [(ngModel)]="paymentMethod">
                <ion-option *ngFor="let p of paymentMethods" value="{{p?.method_id || 'error' }}">
                    {{ p?.method_title || 'error' }}<!-- TODO: ensure all payment-methods have method id's & titles -->
                </ion-option>
            </ion-select>
        </ion-item>

    </ion-list>

</ion-content>

<ion-footer>

    <button ion-button block color="danger" (click)="placeOrder()">Place Order</button>

</ion-footer>